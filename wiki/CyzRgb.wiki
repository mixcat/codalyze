#summary CYZ_RGB: An alternative firmware for [http://thingm.com/products/blinkm BlinkM]

= CYZ_RGB: An alternative firmware for [http://thingm.com/products/blinkm BlinkM] =

BlinkM is a Smart LED produced by [http://thingm.com ThingM]: 

   BlinkM is a “Smart LED”, a networkable and 
   programmable full-color RGB LED for hobbyists,
   industrial designers, prototypers, and experimenters.
    
Just connect it to an I2C bus and start sending commands like "show rgb color" or "fade to hsv value" and so on and so forth (it does much more; see the human-readable [http://thingm.com/fileadmin/thingm/downloads/BlinkM_datasheet.pdf data sheet]).

A bit of explanation: I liked the idea to do a few more things with the leds and decided to modify the firmware. The original firmware is actually closed source (due to legal issues) so I had to start writing a new one from scratch. *This first release is very basic* but hopefully adding new features won't be that hard.

The new firmware has two interesting *additional features* in the works: the ability to act as a *master on the I2C bus* and *support for dallas 1-wire protocol*, to leave one pin free for your creativity.

= Download =

If you decide to download and give it a try, you'll find slave.hex and master.hex: the first is the actual blinkm firmware replacement, the other is the experimental master. You can flash the files on two different blinkms, connect them the to the same i2c bus and watch they change color together.

[http://code.google.com/p/codalyze/source/browse/#svn/cyz_rgb/trunk Browse] the source code.

[http://codalyze.googlecode.com/files/cyz_rgb-alpha1-2008_08_11-binary.zip Download] the binary release.

Get the sources with svn: {{{svn checkout http://codalyze.googlecode.com/svn/cyz_rgb/trunk cyz_rgb}}}

== Interested? I need help ==

I'd like to hear from you. If you have any patch to submit it will be welcome.

_Please not that my experience in C is very limited. And it approaches zero when it comes to microcontroller programming. So, if you are any good at it, please be patient and expect the worse... i'm a java programmer ;). When you stop feeling sick after reading the code, well, drop me a line_

== Implemented features ==

||command name||cmd char||cmd byte||# args||# ret vals||format||implemented||
||*Go to RGB Color Now*||n||0x6e||3||0||{‘n’,R,G,B}||*yes*||
||*Fade to RGB Color*||c||0x63||3||0||{‘c’,R,G,B}||*yes*||
||Fade to HSB Color||h||0x68||3||0||{‘h’,H,S,B}||no||
||Fade to Random RGB Color||C||0x43||3||0||{‘C’,R,G,B}||no||
||Fade to Random HSB Color||H||0x48||3||0||{‘H’,H,S,B}||no||
||Play Light Script||p||0x70||3||0||{‘p’,n,r,p}||yes||
||Stop Script||o||0x6f||0||0||{‘o’}||no||
||Set Fade Speed||f||0x66||1||0||{‘f’,f}||no||
||Set Time Adjust||t||0x74||1||0||{‘t’,t}||no||
||Get Current RGB Color||g||0x67||0||3||{‘g’}||no||
||Write Script Line||W||0x57||7||0||{‘W’,n,p,d,c,a1,a2,a3}||yes^2^||
||Read Script Line||R||0x52||2||5||{‘R’,n,p}||no||
||Set Script Length & Repeats||L||0x4c||3||0||{‘L’,n,l,r}||no||
||Set BlinkM Address||A||0x41||4||0||{‘A’,a...}||no||
||Get BlinkM Address||a||0x61||0||1||{‘a’}||no||
||Get BlinkM Firmware Version||Z||0x5a||0||1||{‘z’}||no|| 
||Set Startup Parameters||B||0x42||5||0||{‘B’,m,n,r,f,t}||no||

^1^ Script number 'n' is ignored: can only play script 0

^2^ Suration 'd' is not supported yet. Only valid commands are go and fade to RGB. Script lines are not persisted and will disappear when blinkm turned off. Script number 'n' is ignored, can only write script 0

== Known bugs ==

   * Sometimes the master gets stuck.
   * ~Sometimes the slave show colors different from the master~.
   * Color fading is a bit less smooth than ~works but is not nearly as nice as~ the original firmware.

Matteo Caprari <matteo.caprari gmail.com>